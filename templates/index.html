<!DOCTYPE html>
<html>
<head>
  <title>GitHub Webhook Events</title>
  <style>
    body { font-family: Arial; text-align: center; padding-top: 100px; }
    #event { font-size: 20px; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>Latest Event</h2>
  <div id="event">Loading...</div>

  <script>
    async function fetchEvent() {
      try {
        const response = await fetch('/events');
        const data = await response.json();

        if (data.length > 0) {
          const e = data[0];
          let msg = '';

          if (e.type === 'push') {
            msg = `"${e.author}" pushed to "${e.to_branch}" on ${e.timestamp}`;
          } else if (e.type === 'pull_request') {
            msg = `"${e.author}" submitted a pull request from "${e.from_branch}" to "${e.to_branch}" on ${e.timestamp}`;
          } else if (e.type === 'merge') {
            msg = `"${e.author}" merged branch "${e.from_branch}" to "${e.to_branch}" on ${e.timestamp}`;
          }

          document.getElementById('event').innerText = msg;
        } else {
          document.getElementById('event').innerText = "No events yet.";
        }
      } catch (err) {
        document.getElementById('event').innerText = "Error loading event.";
        console.error(err);
      }
    }

    fetchEvent();
    setInterval(fetchEvent, 15000);
  </script>
</body>
</html>

